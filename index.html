<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pelotita esquiva pared larga</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>

      <!-- CÃ¡mara superior -->
      <a-entity camera look-controls position="0 10 0" rotation="-90 0 0"></a-entity>

      <!-- Plataforma (suelo) -->
      <a-plane position="0 0 0" rotation="-90 0 0" width="10" height="10" color="#ACE6A3"></a-plane>

      <!-- Pelotita -->
      <a-sphere id="pelotita" position="-4 0.3 0" radius="0.3" color="red"></a-sphere>

      <!-- Meta -->
      <a-box id="meta" position="4 0.5 0" depth="1" height="1" width="1" color="green"></a-box>

      <!-- Pared rectangular (larga) en el centro -->
      <a-box position="0 0.5 0" depth="0.5" height="1" width="6" color="black"></a-box>

    </a-scene>

    <script>
      const pelotita = document.querySelector('#pelotita');
      const pared = new Set();

      // Creamos una pared larga (6 bloques de ancho) en el centro
      for (let x = -3; x <= 3; x++) {
        pared.add(`${x},0`);
      }

      const metaCoord = "4,0";
      const visitados = new Set();

      let x = -4, z = 0;

      function mover() {
        const posiblesMovs = [
          [1, 0],  // derecha
          [0, 1],  // arriba
          [0, -1], // abajo
          [-1, 0]  // izquierda
        ];

        let opciones = posiblesMovs
          .map(([dx, dz]) => [x + dx, z + dz])
          .filter(([nx, nz]) => {
            const key = `${nx},${nz}`;
            const dentroDePlataforma = Math.abs(nx) <= 5 && Math.abs(nz) <= 5;
            return !pared.has(key) && !visitados.has(key) && dentroDePlataforma;
          });

        if (opciones.length === 0) {
          x = -4; z = 0;
          visitados.clear();
        } else {
          let [nx, nz] = opciones[Math.floor(Math.random() * opciones.length)];
          x = nx;
          z = nz;
          visitados.add(`${x},${z}`);
        }

        pelotita.setAttribute('position', `${x} 0.3 ${z}`);

        if (`${x},${z}` === metaCoord) {
          alert("Â¡La pelotita llegÃ³ a la meta rodeando la pared! ðŸŽ‰");
        }
      }

      setInterval(mover, 800);
    </script>
  </body>
</html>
